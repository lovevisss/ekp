require({cache:{"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingAuditNodeContainer":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dijit/_WidgetBase","dojo/dom-geometry","mui/util","dojo/query","dojo/_base/lang"],function(e,d,i,k,h,b,f,j,a,g){return e("sys.lbpmservice.ding.audit.note.nodecontainer",[h],{baseClass:"muiDingAuditNodeItem",store:"",_setStoreAttr:function(l){for(var m in l){if(typeof(this[m])!="undefined"){this.set(m,l[m])}}},startup:function(){this.inherited(arguments)},buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef;if(this.store.status){this.baseClass+=" "+this.store.status}if(this.store.fdActionKey==="_pocess_end"){this.baseClass+=" auditLastNodeItem"}this.inherited(arguments)}})})},"sys/lbpmservice/mobile/audit_note_ext/log/_ImageResizeMixin":function(){define(["dojo/_base/declare","dojo/dom-style","dojo/dom-attr","dojo/on","mui/device/adapter"],function(e,d,f,b,a){return e("sys.lbmpservice.auditNoteExt._ImageResizeMixin",null,{resizeDom:function(i){f.remove(i,"style");var h={height:"auto",textIndent:"0px","max-width":"100%"};d.set(i,h);var g=this;var j=i.src;if(j.indexOf("picthumb")>0){j=j.replace("&picthumb=big","")}b(i,"click",function(k){a.imagePreview({curSrc:j,srcList:g.getSrcList(),previewImgBgColor:g.previewImgBgColor})})}})})},"sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/js/ProcessStatusScrollableViewMixin":function(){define(["dojo/_base/declare","dojo/topic","dojo/query","dojo/dom-style","dojo/_base/array","mui/util","dojox/mobile/viewRegistry","dijit/registry","dojox/mobile/_css3"],function(b,d,i,f,h,e,j,a,k){var g=b("sys.lbpmservice.mobile.lbpm_audit_note.lbpm_process_status.js.ProcessStatusScrollableViewMixin",null,{startup:function(){this.inherited(arguments);this.subscribe("/sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/toTop","handleToTopTopic")},handleToTopTopic:function(){var l=i(".mblScrollableViewContainer",this.domNode)[0];f.set(l,k.name("transform"),"translate3d(0, 0, 0)")}});return g})},"sys/lbpmservice/mobile/audit_note_ext/log/AuditHandlerImgPreview":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojox/mobile/_ItemBase"],function(d,e,a,b){return d("sys.lbpmservice.mobile.audit_note_ext.log.AuditHandlerImgPreview",[b],{buildRendering:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.previewImgBgColor="#fff";this.formatContent(this.domNode)}})})},"sys/lbpmservice/mobile/audit_note_ext/speech/_AuditSpeechItem":function(){define(["dojo/_base/declare","mui/device/device","mui/device/adapter","mui/util"],function(d,e,b,a){return d("sys.lbpmservice.mobile.audit_note_ext.speech._AuditSpeechItem",null,{icon:"mui-voice",openFeature:function(f){var g=a.formatUrl(this.href,true);if(e.getClientType()>6&&e.getClientType()<11){b.playSpeech(g)}else{location=g}}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/LbpmserviceAuditNodeItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dijit/_WidgetBase","dojo/_base/lang","dojo/dom-geometry","mui/device/device","mui/device/adapter","mui/util","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note","dojo/request","dojo/parser","dojo/dom-attr","mui/dialog/Dialog","dijit/registry","dojo/topic","dojo/query"],function(r,h,l,n,k,s,j,p,m,a,g,d,b,q,f,i,o,e){return r("sys.lbpmservice.audit.note.LbpmserviceAuditNodeItem",[k],{baseClass:"muiLbpmserviceAuditNodeItem",hasBorder:false,fdIsHide:"2",store:"",formBeanName:"",_setStoreAttr:function(t){for(var u in t){this.set(u,t[u])}if(t.fdAuditNote==undefined){this.set("fdAuditNote","")}},_setFdAuditNoteAttr:function(t){switch(this.fdIsHide){case"1":this.fdAuditNote='<span class="muiLbpmserviceAuditNodeHide">'+g["mui.lbpmservice.node.hide"]+"</span>";break;case"3":this.fdAuditNote=g["mui.lbpmservice.node.deleted"];break;default:this.fdAuditNote=a.formatText(t)}if(this.fdActionKey=="subFlowNode_start"){this.fdAuditNote=""}},buildRendering:function(){this.domNode=this.srcNodeRef||h.create("div",{className:"muiLbpmserviceAuditNodeItem"});this.containerNode=h.create("div",{className:"muiLbpmserviceAuditNodeItemContainer"},this.domNode);this.inherited(arguments)},startup:function(){this.inherited(arguments);this.contentNode=h.create("div",{className:"muiLbpmserviceAuditNodeContent"});this.reparent();this.noteNode=h.create("p",{className:"muiLbpmserviceAuditNodeNode",innerHTML:this.fdAuditNote,style:{"word-break":"break-word"}},this.contentNode,"first");this.extNoteNode=h.create("p",{className:"muiLbpmserviceExtNoteNode",innerHTML:this.fdExtNote},this.contentNode);this.infoNode=h.create("div",{className:"muiLbpmserviceAuditNodeInfo"},this.containerNode);if(!this.fdHandlerImage){this.fdHandlerImage=dojoConfig.baseUrl+"sys/lbpmservice/mobile/lbpm_audit_note/images/sys_img.png"}var t=h.create("a",{innerHTML:'<span class="muiLbpmserviceAuditNodeImage" style="background:url('+this.fdHandlerImage+') center center no-repeat;background-size:cover;display:inline-block;" ></span>',href:"javascript:;"},this.infoNode);if(this.fdHandlerId){var w=dojoConfig.baseUrl+"sys/zone/index.do?userid="+this.fdHandlerId;this.connect(t,"click",function(B){m.openUserCard({ekpId:this.fdHandlerId,words:window.location.href})})}var z=h.create("h4",{innerHTML:this.fdHandlerName},this.infoNode);h.create("p",{innerHTML:"<span>"+this.fdCreateTime+"</span>",className:"muiLbpmserviceAuditNodeDate mui mui-time"},this.infoNode);if(this.fdAuditNoteFrom){h.create("i",{innerHTML:g["mui.lbpmservice.node.operation.from"]+p.getClientTypeStr(this.fdAuditNoteFrom),className:"muiLbpmserviceAuditNodeFrom"},this.infoNode)}if(this.fdActionKey=="_pocess_end"||this.fdActionKey=="subFlowNode_start"){h.create("p",{className:"muiLbpmserviceAuditNodeActionName",innerHTML:"<em>"+g["mui.lbpmservice.node.operation"]+"：</em>"+this.fdActionInfo+"<br/>"},this.contentNode)}else{var v=true;if(typeof Lbpm_SettingInfo=="undefined"){Lbpm_SettingInfo=new KMSSData().AddBeanData("lbpmSettingInfoService").GetHashMapArray()[0]}if(typeof Lbpm_SettingInfo!="undefined"&&Lbpm_SettingInfo.isShowApprovalTime==="false"){v=false}var x=h.create("p",{className:"muiLbpmserviceAuditNodeActionName",innerHTML:"<em>"+g["mui.lbpmservice.node.operation"]+"：</em>"+this.fdActionInfo},this.contentNode);var A=this.fdCostTimeDisplayString?g["mui.lbpmservice.lbpmAuditNote.fdCostTime"]+": ":"";h.place('<span style="display:'+(v?"inline-block":"none")+';margin-right:0.5rem;">'+A+this.fdCostTimeDisplayString+"</span>",x,"first");if(this.store.fdIsShowLbpmPostscriptIcon==="1"){this.postscriptImage=dojoConfig.baseUrl+"sys/lbpmservice/support/lbpm_audit_note/css/images/icon-lbpmPostscript.png";this.postscriptNode=h.create("a",{className:"muiLbpmserviceAuditLabelItemPostscript",fdAuditNoteId:this.store.fdId,innerHTML:'<span fdAuditNoteId="'+this.store.fdId+'" style="background:url('+this.postscriptImage+') no-repeat;background-size:cover;display:inline-block;width:1.5rem;height:1.5rem;" ></span>',href:"javascript:;"},x);this.connect(this.postscriptNode,"click","_onClick")}}this.lbpmPostscriptNode=h.create("p",{className:"muiLbpmservicePostscriptNode muiLbpmPostscript",innerHTML:""},this.contentNode);h.place(this.contentNode,this.containerNode);if(this.hasBorder){l.add(this.domNode,"muiLbpmserviceAuditNodeItemBorder")}this.subscribe("/mui/lbpmservice/branch_toggle",s.hitch(this,this.branch_toggle));var w=a.formatUrl("/sys/lbpmservice/support/lbpm_postscript/lbpmPostscript.do?method=list4mobile&fdAuditNoteId="+this.store.fdId+"&fdFactNodeId="+this.store.fdNoteId+"&formBeanName="+this.formBeanName);var u=this;d.get(w,{handleAs:"text"}).response.then(function(B){if(B.status==200){var D=B.data;var C=h.toDom(D);h.place(C,u.lbpmPostscriptNode,"last");b.parse(u.lbpmPostscriptNode)}})},_onClick:function(u){var t=this;u=u||window.event;u.cancelBubble=true;if(u.preventDefault){u.preventDefault()}if(u.stopPropagation){u.stopPropagation()}var A=new Date().getTime();var w=this.ctime;if(w!="undefined"&&A-w<500){return false}this.ctime=A;var B=u.srcElement||u.target;var z=q.get(B,"fdAuditNoteId");if(z===this.store.fdId){var v=this;var x=a.formatUrl("/sys/lbpmservice/support/lbpm_postscript/lbpmPostscript.do?method=add&fdAuditNoteId="+this.store.fdId+"&fdFactNodeId="+this.store.fdNoteId+"&formBeanName="+this.formBeanName);d.get(x,{handleAs:"text"}).response.then(function(C){if(C.status==200){var E=C.data;var D=f.element({element:E,showClass:"",position:"center",canClose:true,scrollable:true,parseable:true,buttons:(buttons=[{title:g["mui.lbpmservice.lbpmPostscript.cancel"],fn:function(F){F.hide()}},{title:g["mui.lbpmservice.lbpmPostscript.ok"],fn:function(H){var K=i.byId("scrollView");var G=i.byId("fdPostscript");if(G&&!G.validation.validateElement(G)){return false}var J=e("[name='fdPostscriptFrom']",document.forms.lbpmPostscriptForm)[0];if(J){q.set(J,"value",p.getClientType())}var F=window.location.href;Com_Submit.ajaxAfterSubmit=function(){t.defer(function(){window.location.href=F},100);o.publish("/mui/navitem/selected")};var I=e(".muiFormUploadWrap",document.forms.lbpmPostscriptForm);var K=i.byNode(I[0]);K.checkAttRules();Com_SubmitForm(document.forms.lbpmPostscriptForm,"save","fdId");H.hide()}}]),onDrawed:function(G){n.set(this.containerNode,"min-height","10%");n.set(this.contentNode,"height","auto");n.set(this.contentNode,"max-height","60rem");n.set(this.contentNode,"overflow-y","scroll");n.set(this.domNode,"z-index","100");var H=a.formatUrl("/sys/lbpmservice/support/lbpm_postscript/lbpmPostscript.do?method=getNotifyType&fdFactNodeId="+v.store.fdNoteId+"&fdProcessId="+v.fdProcessId);var I=e("[name='notifyTargetTypeWrap']");d.get(H,{handleAs:"text"}).response.then(function(M){if(M.status==200){var Q=document.getElementById("notifyTypeWrap");var O="<div data-dojo-type=\"mui/form/CheckBoxGroup\" data-dojo-props=\"name:'!{name}',mul:'!{mul}',concentrate:'!{concentrate}',showStatus:'!{showStatus}',store:!{store}\" class=\"muiField\"></div>";var P=JSON.parse(M.data);var K=[];for(var N in P){if(N==="todo"){K.push({text:P[N],value:N,checked:true})}else{K.push({text:P[N],value:N})}}K=JSON.stringify(K);K=K.replace(/\"/g,"'");var L=O.replace("!{name}","fdNotifyType").replace("!{mul}",false).replace("!{concentrate}",false).replace("!{showStatus}","edit").replace("!{store}",K);var J=h.toDom(L);h.place(J,Q,"last");b.parse(Q)}});this.subscribe("mui/form/checkbox/change",function(M){if(M&&M.name==="_fdIsNotify_single"){var L=v.store.fdNoteId;var O=null;var K=e('[name="_fdNotifyTargetType_single"]',I[0]);for(var J=0;J<K.length;J++){var N=K[J];if(N.value=="0"){O=e(N).closest("label")}}if(M.checked){I.forEach(function(P){n.set(P,"display","block")});if(L==="N2"){O[0].style.display="none"}else{O[0].style.display="inline-block"}}else{I.forEach(function(P){n.set(P,"display","none")})}}});var F=e(".lbpmScriptTable")[0];e("td",F).forEach(function(J){n.set(J,"padding","0.5rem 0")})},callback:function(){D=null}})}else{v.loading.innerHTML=g["mui.lbpmservice.lbpmPostscript.load.failure"]}})}},branch_toggle:function(u,t){if(!t){return}if(t.fdExecutionId==this.fdExecutionId){this[t.methodPrex+"Item"](t)}},initHeight:function(){if(!this.height){var t=j.getContentBox(this.domNode);this.height=t.h;n.set(this.domNode,{height:this.height+"px"})}},showItem:function(t){this.initHeight();n.set(this.domNode,{display:"block"});n.set(this.domNode,{height:this.height+"px"})},hideItem:function(){this.initHeight();n.set(this.domNode,{height:0});this.defer(function(){n.set(this.domNode,{display:"none"})},200)},reparent:function(){var v,u,t,w;for(v=0,u=0,t=this.domNode.childNodes.length;v<t;v++){w=this.domNode.childNodes[u];if(w===this.containerNode){u++;continue}this.contentNode.appendChild(this.domNode.removeChild(w))}}})})},"sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/js/ProcessStatusItemMixin":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojo/dom-attr","dojox/mobile/_ItemBase","mui/util","mui/openProxyMixin","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note"],function(e,b,i,g,h,j,f,d,a){var k=e("sys.lbpmservice.mobile.lbpm_audit_note.lbpm_process_status.js.ProcessStatusItemMixin",[j,d],{tag:"div",baseClass:"",icon:"",nodeName:"",fdHandler:"",fdStartDate:"",operationDate:"",operationType:"",operations:"",buildRendering:function(){this.inherited(arguments);this.contentNode=b.create(this.tag,{className:"mui_flowstate_data",style:{"margin-top":".6rem"}});this.buildInternalRender();b.place(this.contentNode,this.containerNode)},buildInternalRender:function(){var m=b.create("div",{className:"mui_flowstate_data_heading"},this.contentNode);var o=b.create("div",{className:"heading_avatar",innerHTML:'<img src="'+f.formatUrl(this.icon)+'">'},m);var n=b.create("div",{className:"heading_content"},m);b.create("h4",{className:"heading_title",innerHTML:this.nodeName},n);b.create("p",{className:"heading_subhead",innerHTML:this.fdHandler},n);n.appendChild(b.toDom(this.operations));var l=b.create("div",{className:"mui_flowstate_data_content"},this.contentNode);var p=b.create("ul",{className:"mui_flowstate_data_timeaxis"},l);b.create("li",{innerHTML:'<span class="title">'+a["mui.lbpm.process.status.fdStartDate"]+'：</span><span class="content">'+this.fdStartDate+"</span>"},p);this.operationDate=this.operationDate.replace(/^\s+|\s+$/gm,"");b.create("li",{innerHTML:'<span class="title">'+a["mui.lbpm.process.status.fdFinishDate"]+'：</span><span class="content">'+this.operationDate+"</span>"},p);b.create("li",{innerHTML:'<span class="title">'+a["mui.lbpm.process.status.operationType"]+'：</span><span class="content">'+this.operationType+"</span>"},p)},startup:function(){if(this._started){return}this.inherited(arguments)},_setLabelAttr:function(l){if(l){this._set("label",l)}}});return k})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingAuditNoteItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dijit/_WidgetBase","dojo/_base/lang","dojo/dom-geometry","mui/device/device","mui/device/adapter","mui/util","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note","dojo/request","dojo/parser","dojo/dom-attr","mui/dialog/Dialog","dijit/registry","dojo/topic","dojo/query"],function(r,h,l,n,k,s,j,p,m,a,g,d,b,q,f,i,o,e){return r("sys.lbpmservice.audit.note.LbpmserviceDingAuditNode",[k],{baseClass:"muiDingAuditNoteItem",hasBorder:false,fdIsHide:"2",store:"",formBeanName:"",_setStoreAttr:function(t){for(var u in t){this.set(u,t[u])}if(t.fdAuditNote==undefined){this.set("fdAuditNote","")}},_setFdAuditNoteAttr:function(t){switch(this.fdIsHide){case"1":this.fdAuditNote='<span class="muiDingAuditNoteHide">'+g["mui.lbpmservice.node.hide"]+"</span>";break;case"3":this.fdAuditNote=g["mui.lbpmservice.node.deleted"];break;default:this.fdAuditNote=a.formatText(t)}if(this.fdActionKey=="subFlowNode_start"){this.fdAuditNote=""}},buildRendering:function(){this.domNode=this.srcNodeRef||h.create("div",{className:"muiDingAuditNoteItem"});this.containerNode=h.create("div",{className:"muiDingAuditNoteItemContainer"},this.domNode);this.inherited(arguments)},startup:function(){this.inherited(arguments);this.contentNode=h.create("div",{className:"muiDingAuditNoteContent"});this.reparent();if(this.fdAuditNote){this.noteNode=h.create("p",{className:"muiDingAuditNote",innerHTML:this.fdAuditNote,style:{"word-break":"break-word"}},this.contentNode,"first")}this.extNoteNode=h.create("p",{className:"muiDingExtNote",innerHTML:this.fdExtNote},this.contentNode);if(this.fdActionKey=="_pocess_end"||this.fdActionKey=="subFlowNode_start"){h.create("p",{className:"muiDingAuditNodeInfo",innerHTML:"<em>"+g["mui.lbpmservice.node.operation"]+"：</em>"+this.fdActionInfo+"</i><br/>"},this.contentNode)}else{var u=true;if(typeof Lbpm_SettingInfo=="undefined"){Lbpm_SettingInfo=new KMSSData().AddBeanData("lbpmSettingInfoService").GetHashMapArray()[0]}if(typeof Lbpm_SettingInfo!="undefined"&&Lbpm_SettingInfo.isShowApprovalTime==="false"){u=false}var w=h.create("p",{className:"muiDingAuditNodeInfo",innerHTML:"<span>"+this.fdActionInfo+"</span>"},this.contentNode);var x=this.fdCostTimeDisplayString?g["mui.lbpmservice.lbpmAuditNote.fdCostTime"]+": ":"";h.place('<span style="display:'+(u?"inline-block":"none")+';">'+x+this.fdCostTimeDisplayString+"</span>",w,"last");if(this.store.fdIsShowLbpmPostscriptIcon==="1"){this.postscriptImage=dojoConfig.baseUrl+"sys/lbpmservice/support/lbpm_audit_note/css/images/icon-lbpmPostscript.png";this.postscriptNode=h.create("a",{className:"postscript",fdAuditNoteId:this.store.fdId,href:"javascript:;"},w);this.connect(this.postscriptNode,"click","_onClick")}}this.lbpmPostscriptNode=h.create("p",{className:"muiDingPostscriptNode muiDingPostscript",innerHTML:""},this.contentNode);h.place(this.contentNode,this.containerNode);if(this.hasBorder){l.add(this.domNode,"muiDingAuditNoteItemBorder")}this.subscribe("/mui/lbpmservice/branch_toggle",s.hitch(this,this.branch_toggle));var v=a.formatUrl("/sys/lbpmservice/support/lbpm_postscript/lbpmPostscript.do?method=list4mobile&fdAuditNoteId="+this.store.fdId+"&fdFactNodeId="+this.store.fdNoteId+"&formBeanName="+this.formBeanName);var t=this;d.get(v,{handleAs:"text"}).response.then(function(C){if(C.status==200){var G=C.data;var E=h.toDom(G);h.place(E,t.lbpmPostscriptNode,"last");b.parse(t.lbpmPostscriptNode);var B=e(".muiLbpmPostscriptTableWrap",t.lbpmPostscriptNode);if(B){for(var D=0;D<B.length;D++){var z=B[D];var F=e(".muiLbpmserviceAuditExpandBtn",z);var A=e(".muiLbpmserviceAuditCollapseBtn",z);if(F&&A){t.connect(F[0],"click",function(){l.add(z,"expand");l.remove(z,"collapse");n.set(F[0],"display","none");n.set(A[0],"display","inline-block")});t.connect(A[0],"click",function(){l.add(z,"collapse");l.remove(z,"expand");n.set(F[0],"display","inline-block");n.set(A[0],"display","none")})}}}}})},_onClick:function(t){t=t||window.event;t.cancelBubble=true;if(t.preventDefault){t.preventDefault()}if(t.stopPropagation){t.stopPropagation()}var z=new Date().getTime();var v=this.ctime;if(v!="undefined"&&z-v<500){return false}this.ctime=z;var A=t.srcElement||t.target;var x=q.get(A,"fdAuditNoteId");if(x===this.store.fdId){var u=this;var w=a.formatUrl("/sys/lbpmservice/support/lbpm_postscript/lbpmPostscript.do?method=add&fdAuditNoteId="+this.store.fdId+"&fdFactNodeId="+this.store.fdNoteId+"&formBeanName="+this.formBeanName);d.get(w,{handleAs:"text"}).response.then(function(B){if(B.status==200){var D=B.data;var C=f.element({element:D,showClass:"",position:"center",canClose:true,scrollable:true,parseable:true,buttons:(buttons=[{title:g["mui.lbpmservice.lbpmPostscript.cancel"],fn:function(E){E.hide()}},{title:g["mui.lbpmservice.lbpmPostscript.ok"],fn:function(G){var J=i.byId("scrollView");var F=i.byId("fdPostscript");if(F&&!F.validation.validateElement(F)){return false}var I=e("[name='fdPostscriptFrom']",document.forms.lbpmPostscriptForm)[0];if(I){q.set(I,"value",p.getClientType())}var E=window.location.href;Com_Submit.ajaxAfterSubmit=function(){window.location.href=E;o.publish("/mui/navitem/selected")};var H=e(".muiFormUploadWrap",document.forms.lbpmPostscriptForm);var J=i.byNode(H[0]);J.checkAttRules();Com_SubmitForm(document.forms.lbpmPostscriptForm,"save","fdId");G.hide()}}]),onDrawed:function(F){n.set(this.containerNode,"min-height","10%");n.set(this.contentNode,"height","auto");n.set(this.contentNode,"max-height","60rem");n.set(this.contentNode,"overflow-y","scroll");n.set(this.domNode,"z-index","100");var G=a.formatUrl("/sys/lbpmservice/support/lbpm_postscript/lbpmPostscript.do?method=getNotifyType&fdFactNodeId="+u.store.fdNoteId+"&fdProcessId="+u.fdProcessId);var H=e("[name='notifyTargetTypeWrap']");d.get(G,{handleAs:"text"}).response.then(function(L){if(L.status==200){var P=document.getElementById("notifyTypeWrap");var N="<div data-dojo-type=\"mui/form/CheckBoxGroup\" data-dojo-props=\"name:'!{name}',mul:'!{mul}',concentrate:'!{concentrate}',showStatus:'!{showStatus}',store:!{store}\" class=\"muiField\"></div>";var O=JSON.parse(L.data);var J=[];for(var M in O){if(M==="todo"){J.push({text:O[M],value:M,checked:true})}else{J.push({text:O[M],value:M})}}J=JSON.stringify(J);J=J.replace(/\"/g,"'");var K=N.replace("!{name}","fdNotifyType").replace("!{mul}",false).replace("!{concentrate}",false).replace("!{showStatus}","edit").replace("!{store}",J);var I=h.toDom(K);h.place(I,P,"last");b.parse(P)}});this.subscribe("mui/form/checkbox/change",function(L){if(L&&L.name==="_fdIsNotify_single"){var K=u.store.fdNoteId;var N=null;var J=e('[name="_fdNotifyTargetType_single"]',H[0]);for(var I=0;I<J.length;I++){var M=J[I];if(M.value=="0"){N=e(M).closest("label")}}if(L.checked){H.forEach(function(O){n.set(O,"display","block")});if(K==="N2"){N[0].style.display="none"}else{N[0].style.display="inline-block"}}else{H.forEach(function(O){n.set(O,"display","none")})}}});var E=e(".lbpmScriptTable")[0];e("td",E).forEach(function(I){n.set(I,"padding","0.5rem 0")})},callback:function(){C=null}})}else{u.loading.innerHTML=g["mui.lbpmservice.lbpmPostscript.load.failure"]}})}},branch_toggle:function(u,t){if(!t){return}if(t.fdExecutionId==this.fdExecutionId){this[t.methodPrex+"Item"](t)}},initHeight:function(){if(!this.height){var t=j.getContentBox(this.domNode);this.height=t.h;n.set(this.domNode,{height:this.height+"px"})}},showItem:function(t){this.initHeight();n.set(this.domNode,{display:"block"});n.set(this.domNode,{height:this.height+"px"})},hideItem:function(){this.initHeight();n.set(this.domNode,{height:0});this.defer(function(){n.set(this.domNode,{display:"none"})},200)},reparent:function(){var v,u,t,w;for(v=0,u=0,t=this.domNode.childNodes.length;v<t;v++){w=this.domNode.childNodes[u];if(w===this.containerNode){u++;continue}this.contentNode.appendChild(this.domNode.removeChild(w))}}})})},"sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/js/ProcessStatusList":function(){define(["dojo/_base/declare","dojo/topic","dojo/dom-construct","dojo/_base/array","dojo/_base/lang","mui/util","mui/list/JsonStoreList"],function(e,d,b,h,g,a,f){return e("sys.lbpmservice.mobile.lbpm_audit_note.lbpm_process_status.js.ProcessStatusList",[f],{postCreate:function(){this.inherited(arguments)}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/LbpmserviceAuditNote":function(){define(["dojo/_base/declare","dijit/_WidgetBase","mui/util","dijit/_Contained","dijit/_Container","dojo/html","dojo/dom-construct","dojo/query","dojo/request"],function(e,h,g,j,a,f,b,i,d){return e("sys.lbpmservice.audit.note",[h,j,a],{url:"/sys/lbpmservice/support/lbpm_audit_note/lbpmAuditNote.do?method=listNote4Mobile",fdModelId:"",fdModelName:"",formBeanName:"",docStatus:"30",lazy:false,rscriptType:/^$|\/(?:java|ecma)script/i,buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef;this.inherited(arguments);this.loading=b.create("span",{innerHTML:'<i class="mui mui-loading mui-spin"></i>记录加载中..'},this.domNode)},getText:function(l){var k=this;var m={};m.fdModelId=this.fdModelId;m.fdModelName=this.fdModelName;m.formBeanName=this.formBeanName;m.docStatus=this.docStatus;d.post(g.formatUrl(this.url),{data:m}).response.then(function(n){if(n.status==200){l.call(k,n.data)}else{k.loading.innerHTML="流程记录加载失败"}})},reload:function(){this.doLoad()},doLoad:function(){if(this.loaded){return}var k=this;this.getText(function(m){var l=new f._ContentSetter({parseContent:true,onEnd:function(){var n=i("script",this.node);n.forEach(function(q,p){if(k.rscriptType.test(q.type||"")){if(q.src){}else{var o=q.text||q.textContent||q.innerHTML||"";o=o.replace(new RegExp("\u2028","gm"),"");window["eval"].call(window,o)}}});this.inherited("onEnd",arguments)}});k.container=b.create("div",{className:"muiLbpmserviceAuditContainer"},k.domNode,"last");l.node=k.container;l.set(m);l.parseDeferred.then(function(n){b.destroy(k.loading)});l.tearDown();k.loaded=true})},startup:function(){this.inherited(arguments);if(!this.lazy){this.doLoad()}}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingAuditNote":function(){define(["dojo/_base/declare","dijit/_WidgetBase","mui/util","dijit/_Contained","dijit/_Container","dojo/html","dojo/dom-construct","dojo/query","dojo/request"],function(e,h,g,j,a,f,b,i,d){return e("sys.lbpmservice.ding.audit.note",[h,j,a],{url:"/sys/lbpmservice/support/lbpm_audit_note/lbpmAuditNote.do?method=listNote4Ding",fdModelId:"",fdModelName:"",formBeanName:"",docStatus:"30",lazy:false,rscriptType:/^$|\/(?:java|ecma)script/i,buildRendering:function(){this.domNode=this.containerNode=this.srcNodeRef;this.inherited(arguments);this.loading=b.create("span",{innerHTML:'<i class="mui mui-loading mui-spin"></i>记录加载中..'},this.domNode)},getText:function(l){var k=this;var m={};m.fdModelId=this.fdModelId;m.fdModelName=this.fdModelName;m.formBeanName=this.formBeanName;m.docStatus=this.docStatus;d.post(g.formatUrl(this.url),{data:m}).response.then(function(n){if(n.status==200){l.call(k,n.data)}else{k.loading.innerHTML="流程记录加载失败"}})},reload:function(){this.doLoad()},doLoad:function(){if(this.loaded){return}var k=this;this.getText(function(m){var l=new f._ContentSetter({parseContent:true,onEnd:function(){var n=i("script",this.node);n.forEach(function(q,p){if(k.rscriptType.test(q.type||"")){if(q.src){}else{var o=q.text||q.textContent||q.innerHTML||"";o=o.replace(new RegExp("\u2028","gm"),"");window["eval"].call(window,o)}}});this.inherited("onEnd",arguments)}});k.container=b.create("div",{className:"muiDingAuditContainer"},k.domNode,"last");l.node=k.container;l.set(m);l.parseDeferred.then(function(n){b.destroy(k.loading)});l.tearDown();k.loaded=true})},startup:function(){this.inherited(arguments);if(!this.lazy){this.doLoad()}}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/LbpmserviceShowFlow":function(){define(["mui/util","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note","mui/dialog/Dialog","dojo/dom-style"],function(b,g,e,a,d){function f(j,i){var h;window.showFlowChart=window.showFlowChartView=function(){var n=b.getUrlParameter(j,"processId");var k=b.formatUrl("/sys/lbpmservice/mobile/lbpm_audit_note/flowchart.jsp?processId="+n,true);h=new a.claz({title:g["lbpm.tab.graphic"],element:'<div id="flowChartView" class="flowChartView"><iframe id="flowChartFrame" width="100%" height="100%" src="'+k+'"  frameborder="0"></iframe><div>',destroyAfterClose:true,closeOnClickDomNode:true,scrollable:true,parseable:true,transform:"bottom",position:"bottom",iconClose:true,showClass:"muiDialogElementShow flowChartViewDialog",buttons:[]});h.show();d.set(h.domNode,{position:"fixed"});d.set(h.contentNode,{"padding-bottom":"0px"});var m=document.getElementById("flowChartFrame");var l=h.contentNode.offsetHeight-50;m.height=l};window.showProcessStatus=function(){var o=b.getUrlParameter(j,"processId"),l=b.getUrlParameter(j,"docStatus");var k=b.formatUrl("/sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/processStatus.jsp?processId="+o+"&docStatus="+l,true);h=new a.claz({title:e["lbpm.process.status.processStatus"],element:'<div id="processStatusView" class="flowChartView"><iframe id="processStatusFrame" width="100%" height="100%" src="'+k+'"  frameborder="0"></iframe><div>',destroyAfterClose:true,closeOnClickDomNode:true,scrollable:true,parseable:true,transform:"bottom",position:"bottom",showClass:"muiDialogElementShow flowChartViewDialog",buttons:[]});h.show();d.set(h.domNode,{position:"fixed"});d.set(h.contentNode,{"padding-bottom":"0px"});var n=document.getElementById("processStatusFrame");var m=h.contentNode.offsetHeight-50;n.height=m};i()}return{load:function(j,h,i){f(j,i)}}})},"sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/js/ProcessStatusItemListMixin":function(){define(["dojo/_base/declare","mui/list/_TemplateItemListMixin","sys/lbpmservice/mobile/lbpm_audit_note/lbpm_process_status/js/ProcessStatusItemMixin"],function(b,d,a){return b("sys.lbpmservice.mobile.lbpm_audit_note.lbpm_process_status.js.ProcessStatusItemListMixin",[d],{itemTemplateString:null,itemRenderer:a})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingUtil":function(){define(["dojo/_base/declare","dojo/_base/window","dojo/on","dojo/query","mui/base64","dojo/Deferred","dojo/promise/all"],function(f,i,b,h,a,e,g){var d=f("mui.lbpm.service.audit.util",null,{generateDefaultDingImg:function(k){var j="<span class='mui-address-imgcontainer-sm mui-ding-address-imgcontainer-sm'><span class='mui-ding-address-name'>"+this.getDingImgName(k)+"</span></span>";return j},getDingImgName:function(j){let showName=j||"";let arr=[];let _isEnglish=showName.match(/^([a-zA-Z]|\s|,|\.)+$/)!==null?true:false;if(_isEnglish){showName=showName.replace(/,|\./g," ").replace(/\s+/g," ");arr=showName.split(" ");if(arr.length===1){return showName.slice(0,2)}return arr[0].slice(0,1)+arr[1].slice(0,1)}return showName.replace(/,|\.|\s+/g,"").slice(-2)}});return new d()})},"sys/lbpmservice/mobile/audit_note_ext/Canvas":function(){define(["dojo/_base/declare","dojo/on","dojo/dom-geometry"],function(d,a,b){return d("sys.lbpmservice.mobile.audit_note_ext.Canvas",null,{domCanvas:null,context:null,offsetPos:null,lastPos:null,isPress:false,constructor:function(e){this.inherited(arguments);this.domCanvas=(e||document.createElement("canvas"));this.init();this.bindEvents()},init:function(){this.context=this.domCanvas.getContext("2d")},getContext:function(){return this.context},getDomCanvas:function(){return this.domCanvas},clearRect:function(){this.context.clearRect(0,0,this.domCanvas.width,this.domCanvas.height)},toDataURL:function(e){return this.domCanvas.toDataURL(e)},drawImage:function(g){var f=0,k=0;var i=this.domCanvas.width;var e=this.domCanvas.height;var h=g.width;var j=g.height;if(i>h){f=(i-h)/2;i=h}else{f=0}if(e>j){k=(e-j)/2;e=j}else{k=0}this.context.drawImage(g,f,k,i,e)},bindEvents:function(){var e=this;a(this.domCanvas,"touchstart",function(f){e.start(f);f.preventDefault()});a(this.domCanvas,"touchmove",function(f){e.move(f);f.preventDefault()});a(this.domCanvas,"touchend",function(f){e.end();f.preventDefault()});a(this.domCanvas,"touchcancel",function(f){e.end();f.preventDefault()})},start:function(f){this.offsetPos=b.position(this.domCanvas);this.isPress=true},move:function(g){if(!this.isPress){return}var f={x:g.pageX-this.offsetPos.x,y:g.pageY-this.offsetPos.y};if(this.lastPos!=null){this.context.lineJoin="round";this.context.lineCap="round";this.context.beginPath();this.context.moveTo(this.lastPos.x,this.lastPos.y);this.context.lineTo(f.x,f.y);this.context.stroke()}this.lastPos=f},end:function(f){this.isPress=false;this.lastPos=null}})})},"sys/lbpmservice/mobile/audit_note_ext/hand/PenSelect":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-construct","dojo/dom-class","dojo/topic","dojo/query"],function(d,f,a,e,b,g){return d("sys.lbpmservice.mobile.audit_note_ext._PenBaseSelect",[f],{label:"",name:"",store:[],value:null,postMixInProperties:function(){this.inherited(arguments)},buildRendering:function(){var h=this;this.inherited(arguments);e.add(this.domNode,"muiPenSelect");this.valueNode=a.create("input",{type:"hidden",value:this.value,name:this.name},this.domNode);a.create("div",{className:"muiPenSelectLabel",innerHTML:this.label},this.domNode);var o=a.create("div",{className:"muiPenSelectCircleContainer"},this.domNode);for(var m=0;m<this.store.length;m++){var n="muiPenSelectCircle ";if(this.value===this.store[m].value){n+="selected"}var k=a.create("span",{className:n},o);var j=a.create("div",{className:"muiPenSelectCircleOuter"},k);var l=a.create("div",{className:"muiPenSelectCircleInner"},j);a.create("i",{className:"mui mui-pitchon"},l);this.connect(k,"click",(function(i){return function(p){h.valueNode.value=h.store[i].value;h.selectNode(i);b.publish("sys/lbpmservice/select/pen",{name:this.name})}})(m))}},selectNode:function(h){var k=g(".muiPenSelectCircle",this.domNode);for(var j=0;j<k.length;j++){e.remove(k[j],"selected")}e.add(k[h],"selected")}})})},"sys/lbpmservice/mobile/audit_note_ext/sign/AuditNoteSign":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/_base/array","dojo/on","dijit/_WidgetBase","dojox/mobile/TransitionEvent","dojo/dom-style","dojo/dom-construct","dojo/query","dojo/touch","dojo/dom-attr","dojo/dom","dojo/topic","mui/device/device","mui/device/adapter","sys/lbpmservice/mobile/audit_note_ext/_CanvasView","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note"],function(r,s,a,g,h,p,l,j,e,d,f,q,o,k,m,i,n,b){return r("sys.lbpmservice.mobile.audit_note_ext.sign.AuditNoteSign",[n],{descriptionDiv:null,buttonDiv:null,isFitCanvas:false,startup:function(){this.inherited(arguments);if(m.getClientType()>6&&m.getClientType()<11&&m.getClientType()!=7){this.createBtn();this.bindEvents()}},bindEvents:function(){this.inherited(arguments);var t=d(this.descriptionDiv).parent()[0];h(t,h.selector("#signDiv li i.signClose",f.press),s.hitch(this,this.signDelete));h(t,h.selector("#signDiv li i.signIcon",f.press),s.hitch(this,this.signModify));h(t,h.selector("#signDiv li span.signName",f.press),s.hitch(this,this.signModify))},createBtn:function(){var u=d(this.buttonDiv);var t='<div class="handingWay" id="digitalSignature">';t+='<div class="iconArea"><i class="mui mui-write"></i></div><span class="iconTitle">'+b["mui.lbpmNode.usage.sign"]+"</span></div>";u.append(t);d("#digitalSignature").on("click",s.hitch(this,this.showSign))},showSign:function(){if(m.getClientType()>6&&m.getClientType()<11&&m.getClientType()!=7){var u=d("#signOptBar");if(lbpm._mobileView){k.publish("/lbpm/operation/hideDialog",this);new l(a.body(),{moveTo:lbpm._mobileView,transition:"flip",transitionDir:-1}).dispatch()}if(u.length>0){u[0].remove()}else{var t="<div id='signOptBar'><i class='signOptIcon mui mui-capture'></i></div>";u=e.toDom(t);e.place(u,document.body,"last");var v=this;this.connect(u,f.press,function(){j.set(u,{display:"none"});if(o.byId("_flowNav")){j.set(o.byId("_flowNav"),{display:"none"})}v.defer(function(){i.captureScreen(function(w){v.drawImage(w)})},500);u.remove()})}}else{i.captureScreen(this.drawImage)}},drawImage:function(u){this.showAuditNoteHandlerView();var t=this;this.curImg=new Image();this.curImg.onload=function(){t.canvas.fromDataURL(u,{ratio:1})};this.curImg.src=u},hideAuditNoteHandlerView:function(){this.inherited(arguments);this.canvas.clear();if(lbpm._mobileView){k.publish("/lbpm/operation/showDialog",this)}},auditNoteViewClear:function(){this.inherited(arguments)},UploadSuccessed:function(w,u){var x=u.file;var z=d("#signDiv");var t="<li imgHref='"+x.href+"'><div>";t+="<i class='signIcon mui mui-sign'></i>";t+="<span class='signName'>"+x.name+"</span>";t+="<i class='signClose mui mui-close' id='"+x.filekey+"'></i>";t+="</div></li>";if(z.length>0){if(z.innerHTML()==""){z.innerHTML(t)}else{z.append(t)}}else{var v="<div class='signArea'><ul id='signDiv'>"+t+"</ul></div>";d(this.descriptionDiv).after(v)}},signDelete:function(t){var v=t.target;if(v&&v.tagName=="I"){this.fileIds=g.filter(this.fileIds,function(w){return w!=v.id});var u=d("#signDiv > li");if(u.length>1){d(v).parents("#signDiv > li").remove()}else{d("#signDiv").parents("div.signArea").remove()}}},signModify:function(t){}})})},"sys/lbpmservice/mobile/audit_note_ext/speech/AuditNoteSpeech":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/ready","dijit/_WidgetBase","mui/dialog/Tip","dojo/dom-style","dojo/dom-attr","dojo/query","dojo/touch","mui/device/device","mui/device/adapter","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note"],function(g,b,i,j,n,e,o,h,l,k,f,a,m,d){return g("sys.lbpmservice.mobile.audit_note_ext.speech.AuditNoteSpeech",[e],{descriptionDiv:null,buttonDiv:null,fdKey:"",fdAttType:"byte",fdModelId:"",fdModelName:"",fdMulti:true,editMode:true,files:[],startup:function(){this.inherited(arguments);if(a.getClientType()>6&&a.getClientType()<11){this.createBtn();this.bindEvents()}},bindEvents:function(){var q="attachmentObject_"+this.fdKey+"_";this.subscribe(q+"success","speechSuccess");this.subscribe(q+"fail","speechError");var p=k(this.descriptionDiv).parent()[0];j(p,j.selector("#speechDiv li i.speechClose",f.press),b.hitch(this,this.speechDelete));j(p,j.selector("#speechDiv li i.speechIcon",f.press),b.hitch(this,this.playSpeech));j(p,j.selector("#speechDiv li span.speechName",f.press),b.hitch(this,this.playSpeech));n(b.hitch(this,function(){Com_Parameter.event.submit.push(b.hitch(this,this.submitEvent))}))},submitEvent:function(){if(this.files.length>0){var p=window.AttachmentList[this.fdKey];if(p!=null){return i.every(this.files,function(q){var r=p.registFile({filekey:q.filekey,name:q.name});return r!=null},this)}}return true},createBtn:function(){var q=k(this.buttonDiv);var p='<div class="handingWay" id="voiceHanding">';p+='<div class="iconArea"><i class="mui mui-voice"></i></div><span class="iconTitle">'+d["mui.lbpmNode.usage.speech"]+"</span></div>";q.append(p);k("#voiceHanding").on("click",b.hitch(this,this.showSpeech))},showSpeech:function(p){m.openSpeech({options:this,evt:p})},speechDelete:function(p){var r=p.target;if(r&&r.tagName=="I"){this.files=i.filter(this.files,function(s){return s.filekey!=r.id});var q=k("#speechDiv > li");if(q.length>1){k(r).parents("#speechDiv > li").remove()}else{k("#speechDiv").parents("div.speechArea").remove()}}},playSpeech:function(p){var s=p.target;if(s&&(s.tagName=="I"||s.tagName=="SPAN")){var q=k(s).parents("#speechDiv > li");if(q.length>0){var r=l.get(q[0],"playHref");if(r!=null&&r!=""){m.playSpeech(r)}}}},speechSuccess:function(u,q){if(q==null||q.file==null){return}var t=q.file;this.files.push(t);var r=k("#speechDiv");var p="<li playHref='"+(t.fullpath||t.fullPath)+"' id='li_"+t.filekey+"'><div>";p+="<i class='speechIcon mui mui-play'></i>";p+="<span class='speechName'>"+t.name+"</span><i id='"+t.filekey+"' class='speechClose mui mui-close'></i>";p+="</div></li>";if(r.length>0){if(r.innerHTML()==""){r.innerHTML(p)}else{r.append(p)}}else{var s="<div class='speechArea'><ul id='speechDiv'>"+p+"</ul></div>";k(this.descriptionDiv).after(s)}},speechError:function(q,p){if(p&&p.rtn&&p.rtn.msg){o.fail({text:p.rtn.msg})}}})})},"sys/lbpmservice/mobile/audit_note_ext/log/AuditLogItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojox/mobile/_ItemBase","mui/device/adapter","mui/util"],function(f,g,d,e,b,a){return f("sys.lbpmservice.mobile.audit_note_ext.log.AuditLogItem",[e],{href:"",label:"",baseClass:"muiAuditLogItem",icon:"mui-voice",fdId:"",buildRendering:function(){this.inherited(arguments);this.content=d.create("div",{className:"muiAuditLogItemInfo"},this.domNode);d.create("i",{className:"muiAuditLogItemPlay mui "+this.icon},this.content);d.create("span",{className:"muiAuditLogItemName",innerHTML:this.label},this.content);d.create("i",{className:"muiAuditLogItemMore mui mui-forward"},this.content)},postCreate:function(){this.inherited(arguments);this.connect(this.content,"click",function(h){this.defer(function(){this.openFeature(h)},350)})},isImage:function(){if(this.label){var h="";if(this.label.lastIndexOf(".")>-1){h=this.label.substring(this.label.lastIndexOf(".")+1);if(h!=""){h=h.toLowerCase()}if(h=="jpg"||h=="jpeg"||h=="ico"||h=="bmp"||h=="gif"||h=="png"||h=="tif"){return true}}}return false},openFeature:function(h){if(!this.isImage()){location=a.formatUrl(this.href)}else{var i=a.formatUrl(this.viewPicHref,true);b.imagePreview({curSrc:i,srcList:[i],previewImgBgColor:""})}},_setLabelAttr:function(h){if(h){this._set("label",h)}}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingAuditNode":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dijit/_WidgetBase","dojo/dom-geometry","mui/util","dojo/query","dojo/_base/lang","mui/iconUtils",dojoConfig.baseUrl+"sys/lbpmservice/mobile/lbpm_audit_note/js/_LbpmserviceAuditLabelItemToggleMixin.js"],function(f,e,j,l,i,d,g,k,b,a,h){return f("sys.lbpmservice.ding.audit.note.node",[i,h],{baseClass:"muiDingAuditNodeItem",fdExecutionId:"",fdFactNodeName:"",store:"",expandItems:true,nodeFlag:"normal",_setStoreAttr:function(m){for(var n in m){if(typeof(this[n])!="undefined"){this.set(n,m[n])}}},startup:function(){this.inherited(arguments);this.subscribe("/mui/lbpmservice/branch_toggle",b.hitch(this,this.branch_toggle))},buildRendering:function(){this.icon=null;this.domNode=this.containerNode=this.srcNodeRef;if(this.store.pass==="30"){this.baseClass+=" pass"}if(this.store.pass==="31"){this.baseClass+=" reject"}this.dotNode=e.create("div",{className:"muiDingAuditLabelItem muiDingAuditNormal"},this.domNode,"first");var p="muiDingAuditLabelItemDot muiLbpmProcessSystem";if(this.store.fdProcessType=="2"){p+=" muiLbpmProcessJoint"}if(this.store.fdProcessType=="1"){p+=" muiLbpmProcessParallel"}this.itemDot=e.create("div",{className:p,innerHTML:"<i></i>"},this.dotNode);var q=this.store.historyHandlers.length+this.store.currentHandlers.length;var o=false;if(this.store.currentHandlers.length==0){o=true}var s="";var n="";if(this.store.fdProcessType=="1"){s=this.store.fdFactNodeName+"(并行)";n=q+"人任意1人通过审批即可";if(this.store.pass=="30"){n+="(已通过)"}else{if(this.store.pass=="31"){n+="(已驳回)"}else{n+="(审批中)"}}}else{if(this.store.fdProcessType=="2"){s=this.store.fdFactNodeName+"(会审)";n="需"+q+"人全部审批通过";if(this.store.pass=="30"){n+="(已通过)"}else{if(this.store.pass=="31"){n+="(已驳回)"}else{n+="("+this.store.historyHandlers.length+"人已审批通过)"}}}}this.itemHead=e.create("div",{className:"muiDingAuditLabelItemHead",innerHTML:"<div>"+s+"</div>"},this.dotNode);this.nodeInfo=e.create("div",{className:"muiDingAuditLabelNodeInfo",innerHTML:n},this.dotNode);this.handler=e.create("div",{className:"muiDingAuditNoteHandler"},this.dotNode);var r=e.create("div",{className:"muiDingAuditNodeBtn"},this.itemHead);var m=e.create("span",{className:"muiDingAuditNodeExpandBtn"},r);var t=e.create("span",{className:"muiDingAuditNodeCollapseBtn"},r);this.builderHandlers();var u=this;this.connect(m,"click",function(){l.add(u.domNode,"expand");l.remove(u.domNode,"collapse");j.set(m,"display","none");j.set(t,"display","inline")});this.connect(t,"click",function(){l.add(u.domNode,"collapse");l.remove(u.domNode,"expand");j.set(m,"display","inline");j.set(t,"display","none")});this.inherited(arguments)},builderHandlers:function(){var n=this.store;var m=n.historyHandlers;var q=n.currentHandlers;if(m){for(var o=0;o<m.length;o++){var p=m[o];this.buildHandlerInfo(p,false)}}if(q){for(var o=0;o<q.length;o++){var p=q[o];this.buildHandlerInfo(p,true)}}},buildHandlerInfo:function(o,q){var n=q?"current":"history";var m=e.create("span",{className:"muiDingAuditNodeHandler "+n},this.handler);var p="";if(o.fdDingImg){p="<img src='"+o.fdDingImg+"' />"}else{p=a.createDingIcon(o.fdName)}p+="<label>"+o.fdName+"</label>";e.place(p,m,"last")}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingAuditBranchItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dijit/_WidgetBase","dojo/_base/lang","dojo/topic"],function(e,a,f,d,h,g,b){return e("sys.lbpmservice.audit.note.LbpmserviceDingAuditBranchItem",[h],{baseClass:"muiLbpmserviceAuditBranchItem",fdExecutionId:"",fdParentExecutionId:"",fdFactNodeName:"",store:null,setStoreAttr:function(){if(!this.params||!this.params.store){return}var i=this.params.store;for(var j in i){if(typeof(this[j])!="undefined"){this.set(j,i[j])}}},buildRendering:function(){this.setStoreAttr();this.domNode=this.containerNode=this.srcNodeRef;var i=a.create("div",{className:"muiLbpmserviceAuditBranchContent"});this.titleNode=a.create("span",{className:"muiLbpmserviceAuditBranchTitle",innerHTML:this.fdFactNodeName+"<i></i>"},i);a.place(i,this.containerNode);this.inherited(arguments)},methodPrex:"show",getMehtodPrex:function(){return this.methodPrex=="show"?"hide":"show"},startup:function(){this.inherited(arguments);this.connect(this.domNode,"onclick","_onClick");this.subscribe("/mui/lbpmservice/branch_toggle",g.hitch(this,this.branch_toggle));this.subscribe("/mui/lbpmservice/label_toggle",g.hitch(this,this.label_toggle))},_setMethodPrexAttr:function(j){var i="hide";j=="hide"?f.add(this.titleNode,i):f.remove(this.titleNode,i);this.methodPrex=j},_onClick:function(i){this._branch_toggle()},_branch_toggle:function(j){var i=j?j:this.getMehtodPrex();b.publish("/mui/lbpmservice/branch_toggle",this,{fdExecutionId:this.fdExecutionId,fdParentExecutionId:this.fdParentExecutionId,methodPrex:i});this.set("methodPrex",i)},branch_toggle:function(j,i){if(!i||j==this){return}if(i.fdExecutionId==this.fdParentExecutionId){this[i.methodPrex+"Item"](i)}},label_toggle:function(j,i){if(!i||j==this){return}if(i.fdExecutionId==this.fdParentExecutionId){this[i.methodPrex+"Item"](i)}},showItem:function(i){d.set(this.domNode,{height:"auto"});this.defer(function(){d.set(this.domNode,{display:"block"})},1)},hideItem:function(){d.set(this.domNode,{height:0});this.defer(function(){d.set(this.domNode,{display:"none"})},1);this._branch_toggle("hide")}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/LbpmserviceAuditLabelItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dijit/_WidgetBase","mui/util","dojo/query","dojo/_base/lang",dojoConfig.baseUrl+"sys/lbpmservice/mobile/lbpm_audit_note/js/_LbpmserviceAuditLabelItemToggleMixin.js"],function(e,b,d,i,a,f,h,g){return e("sys.lbpmservice.audit.note.LbpmserviceAuditLabelItem",[i,g],{baseClass:"muiLbpmserviceAuditLabelItem",fdExecutionId:"",fdFactNodeName:"",store:"",nodeFlag:"normal",_setStoreAttr:function(j){for(var k in j){if(typeof(this[k])!="undefined"){this.set(k,j[k])}}},_setFdFactNodeNameAttr:function(j){this.fdFactNodeName=j;if(!this.titleNode){this.titleNode=b.create("div",{className:"muiLbpmserviceAuditLabelItemTitle",innerHTML:Com_HtmlEscape(j)},this.domNode)}},startup:function(){this.inherited(arguments);this.subscribe("/mui/lbpmservice/branch_toggle",h.hitch(this,this.branch_toggle))},buildRendering:function(){if("start"==this.nodeFlag){this.icon="mui mui-play";this.baseClass="muiLbpmserviceAuditLabelItem muiLbpmserviceAuditStart"}else{if("end"==this.nodeFlag){this.icon="mui mui-stop";this.baseClass="muiLbpmserviceAuditLabelItem muiLbpmserviceAuditEnd"}else{this.icon=null;this.baseClass="muiLbpmserviceAuditLabelItem muiLbpmserviceAuditNormal"}}this.domNode=this.containerNode=this.srcNodeRef;this.dotNode=b.create("div",{className:"muiLbpmserviceAuditLabelItemDot",innerHTML:'<i class="'+(this.icon?this.icon:"")+'"></i>'},this.domNode);this.inherited(arguments)},branch_toggle:function(k,j){if(!j){return}if(j.fdExecutionId==this.fdExecutionId){this[j.methodPrex+"Item"](j)}},showItem:function(j){d.set(this.domNode,{height:"auto"});this.defer(function(){d.set(this.domNode,{display:"block"})},1)},hideItem:function(){d.set(this.domNode,{height:0});this.defer(function(){d.set(this.domNode,{display:"none"})},1)}})})},"sys/lbpmservice/mobile/audit_note_ext/sign/_AuditSignItem":function(){define(["dojo/_base/declare"],function(a){return a("sys.lbpmservice.mobile.audit_note_ext.sign._AuditSignItem",null,{icon:"mui-sign"})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingNextAuditLabelItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dijit/_WidgetBase","mui/util","dojo/query","dojo/_base/lang","mui/iconUtils",dojoConfig.baseUrl+"sys/lbpmservice/mobile/lbpm_audit_note/js/_LbpmserviceAuditLabelItemToggleMixin.js"],function(e,d,i,h,f,j,b,a,g){return e("sys.lbpmservice.audit.note.LbpmserviceDingNextAuditLabelItem",[h,g],{baseClass:"muiDingAuditLabelItemTitle",handlerName:"",handlerImg:"",startup:function(){this.inherited(arguments)},buildRendering:function(){this.icon=null;this.domNode=this.containerNode=this.srcNodeRef;this.dotNode=d.create("div",{className:"muiDingAuditLabelItemDot"},this.domNode);this.buildHandlerInfo();this.titleNode=d.create("span",{className:"muiDingAuditLabelTitle",innerHTML:this.handlerName},this.domNode);this.inherited(arguments)},buildHandlerInfo:function(){var l="";if(this.handlerImg){l="<span class='auditDingNoteHandlerIcon'><img width='20px' height='20px' src='"+this.handlerImg+"' /></span>"}else{if(this.handlerName){var m=this.handlerName;if(this.handlerName){var k=this.handlerName.split(";");m=k[0]}l=a.createDingIcon(m)}else{l='<span class="muiDingNoteSystem"></span>'}}d.place(l,this.dotNode,"last")}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/dingSuit/LbpmserviceDingAuditLabelItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dijit/_WidgetBase","mui/util","dojo/query","dojo/_base/lang","mui/iconUtils",dojoConfig.baseUrl+"sys/lbpmservice/mobile/lbpm_audit_note/js/_LbpmserviceAuditLabelItemToggleMixin.js"],function(e,d,i,h,f,j,b,a,g){return e("sys.lbpmservice.audit.note.LbpmserviceDingAuditLabelItem",[h,g],{baseClass:"muiDingAuditLabelItemTitle",fdExecutionId:"",fdHandlerName:"",fdCreateTime:"",store:"",nodeFlag:"normal",_setStoreAttr:function(k){for(var l in k){if(typeof(this[l])!="undefined"){this.set(l,k[l])}}},startup:function(){this.inherited(arguments)},buildRendering:function(){this.icon=null;var l=this.store.status?this.store.status:"";this.domNode=this.containerNode=this.srcNodeRef;this.dotNode=d.create("div",{className:"muiDingAuditLabelItemDot "+l},this.domNode);this.buildHandlerInfo();var m="";if(!this.store.hasOuterBorder){m=this.store.fdFactNodeName}var k=m;if(!this.store.hasOuterBorder){k+="("+this.store.fdHandlerName+")"}else{k+=this.store.fdHandlerName}this.titleNode=d.create("span",{className:"muiDingAuditLabelTitle",innerHTML:k},this.domNode);if(this.store.fdCreateTime){d.create("span",{className:"muiDingAuditNoteCreateTime",innerHTML:this.store.fdCreateTime},this.domNode)}this.inherited(arguments)},buildHandlerInfo:function(){var m=this.store;var k=m.historyHandlers;var l="";if(m.fdDingImg){l="<span class='auditDingNoteHandlerIcon'><img width='20px' height='20px' src='"+m.fdDingImg+"' /></span>"}else{if(m.fdHandlerImage){l=a.createDingIcon(m._fdHandlerName||m.fdHandlerName)}else{l='<span class="muiDingNoteSystem"></span>'}}d.place(l,this.dotNode,"last")}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/LbpmserviceAuditBranchItem":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dijit/_WidgetBase","dojo/_base/lang","dojo/topic"],function(e,a,f,d,h,g,b){return e("sys.lbpmservice.audit.note.LbpmserviceAuditBranchItem",[h],{baseClass:"muiLbpmserviceAuditBranchItem",fdExecutionId:"",fdParentExecutionId:"",fdFactNodeName:"",store:null,setStoreAttr:function(){if(!this.params||!this.params.store){return}var i=this.params.store;for(var j in i){if(typeof(this[j])!="undefined"){this.set(j,i[j])}}},buildRendering:function(){this.setStoreAttr();this.domNode=this.containerNode=this.srcNodeRef;var i=a.create("div",{className:"muiLbpmserviceAuditBranchContent"});this.titleNode=a.create("span",{className:"muiLbpmserviceAuditBranchTitle",innerHTML:this.fdFactNodeName+"<i></i>"},i);a.place(i,this.containerNode);this.inherited(arguments)},methodPrex:"show",getMehtodPrex:function(){return this.methodPrex=="show"?"hide":"show"},startup:function(){this.inherited(arguments);this.connect(this.domNode,"onclick","_onClick");this.subscribe("/mui/lbpmservice/branch_toggle",g.hitch(this,this.branch_toggle));this.subscribe("/mui/lbpmservice/label_toggle",g.hitch(this,this.label_toggle))},_setMethodPrexAttr:function(j){var i="hide";j=="hide"?f.add(this.titleNode,i):f.remove(this.titleNode,i);this.methodPrex=j},_onClick:function(i){this._branch_toggle()},_branch_toggle:function(j){var i=j?j:this.getMehtodPrex();b.publish("/mui/lbpmservice/branch_toggle",this,{fdExecutionId:this.fdExecutionId,fdParentExecutionId:this.fdParentExecutionId,methodPrex:i});this.set("methodPrex",i)},branch_toggle:function(j,i){if(!i||j==this){return}if(i.fdExecutionId==this.fdParentExecutionId){this[i.methodPrex+"Item"](i)}},label_toggle:function(j,i){if(!i||j==this){return}if(i.fdExecutionId==this.fdParentExecutionId){this[i.methodPrex+"Item"](i)}},showItem:function(i){d.set(this.domNode,{height:"auto"});this.defer(function(){d.set(this.domNode,{display:"block"})},1)},hideItem:function(){d.set(this.domNode,{height:0});this.defer(function(){d.set(this.domNode,{display:"none"})},1);this._branch_toggle("hide")}})})},"sys/lbpmservice/mobile/audit_note_ext/_CanvasView":function(){define(["dojo/_base/declare","dojox/mobile/View","dojo/query","dojo/dom","dojox/mobile/TransitionEvent","dijit/registry","dojo/_base/window","mui/util","dojo/_base/lang","dojo/_base/array","dojo/dom-style","dojo/ready","mui/dialog/Tip","mui/device/adapter","dojox/mobile/viewRegistry","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note"],function(g,b,m,f,l,a,j,h,d,k,i,p,q,o,n,e){return g("sys.lbpmservice.mobile.audit_note_ext._CanvasView",[b],{fdKey:"",fdAttType:"pic",fdModelId:"",fdModelName:"",lbpmViewName:null,uploadStream:true,canvas:null,fileIds:[],_working:false,isFitCanvas:true,startup:function(){this.inherited(arguments);this.fileIds=[];m(this.domNode).style("display","none");h.addTopView(this.domNode);this.findAppBar()},findAppBar:function(){if(this.domNode.parentNode){for(var s=0,r=this.domNode.parentNode.childNodes.length;s<r;s++){c=this.domNode.parentNode.childNodes[s];this.checkFixedBar(c)}}},checkFixedBar:function(r){if(r.nodeType===1&&r.getAttribute("data-dojo-type")=="mui/fixed/Fixed"){this.fixedHeader=r}},bindEvents:function(){var r="attachmentObject_"+this.fdKey+"_";this.subscribe(r+"success","AttUploadSuccess");this.subscribe(r+"success_ereb","AttUploadSuccessEreb");this.subscribe(r+"fail","AttUploadError");this.subscribe("sys/lbpmservice/select/pen","selectPenChange");a.byNode(m(".auditNoteHandlerCancel",this.domNode)[0]).on("click",d.hitch(this,this.hideAuditNoteHandlerView));a.byNode(m(".auditNoteHandlerClear",this.domNode)[0]).on("click",d.hitch(this,this.auditNoteViewClear));a.byNode(m(".auditNoteHandlerSave",this.domNode)[0]).on("click",d.hitch(this,this.auditNoteViewSave));if(!this.isXformAuditNote){p(d.hitch(this,function(){var s=this;setTimeout(function(){Com_Parameter.event.submit.push(d.hitch(s,s.submitEvent))},200)}))}},submitEvent:function(){if(!this.uploaded){if(this.fileIds.length>0){var s=window.AttachmentList[this.fdKey];var r=window.AttachmentList[this.fdKey+"_rawFile"];if(s!=null){return k.every(this.fileIds,function(t){var u=s.registFile({filekey:t,name:"image.png"});return u!=null},this)}}this.uploaded=true}return true},resize:function(){this.inherited(arguments);this.resizeCanvas(false)},releaseCanvas:function(){this.canvas=null;m(".canvasDiv",this.domNode).empty()},resizeCanvas:function(x){var E=m(".canvasDiv",this.domNode)[0];var s=m(".auditNoteHandlerToolbar",this.domNode)[0];var w=m(".auditNoteHandlerHeader",this.domNode)[0];var A=h.getScreenSize();var v=A.h-s.offsetHeight-w.offsetHeight;if(this.fixedHeader){v=v-this.fixedHeader.offsetHeight}E.style.height=v+"px";var r=E.offsetWidth;var C=E.offsetHeight;var z=false;var B=document.createElement("canvas");if(!this.canvas){E.appendChild(B);i.set(B,{width:"100%",height:"100%"})}else{B=this.canvas.canvas}var r=E.offsetWidth;var C=E.offsetHeight;var t=B.width,u=B.height;if(t!=r||u!=C){B.width=r;B.height=C;z=true}if(!this.canvas){var D=this;require(["sys/lbpmservice/mobile/lib/signaturePad"],function(F){D.canvas=new F(B,{backgroundColor:"#fff"});if(z){D.dowidthchange();D.docolorchange()}});return}if(z){this.dowidthchange();this.docolorchange()}},selectPenChange:function(r){if(r.name=="selectPenWidth"){this.dowidthchange()}if(r.name=="selectPenColor"){this.docolorchange()}},getLineWidth:function(){var s=m("[name='selectPenWidth']",this.domNode)[0];var r=s.value;return r},getStrokeStyle:function(){var s=m("[name='selectPenColor']",this.domNode)[0];var r=s.value;return r},dowidthchange:function(){if(this.canvas){this.canvas.maxWidth=this.getLineWidth()}},docolorchange:function(){if(this.canvas){this.canvas.penColor=this.getStrokeStyle()}},auditNoteViewClear:function(){this.canvas.clear()},showAuditNoteHandlerView:function(){new l(j.body(),{moveTo:this.id,transition:"flip"}).dispatch()},onAfterTransitionIn:function(){this.inherited(arguments);this.resize()},hideAuditNoteHandlerView:function(){if(f.byId("_flowNav")){i.set(f.byId("_flowNav"),{display:"block"})}var s=this.lbpmViewName?this.lbpmViewName:"lbpmView";if(this.showType=="dialog"){s=this.backTo;if(!s){var r=n.getEnclosingView(this.domNode);r=n.getParentView(r);s=r?r.id:"scrollView"}}new l(j.body(),{moveTo:s,transition:"flip",transitionDir:-1}).dispatch()},getResult:function(r){var s={};k.forEach(r.firstChild.childNodes,function(t){if(t.nodeType==1){s[t.nodeName]=t.firstChild.nodeValue}});return s},workDone:function(){this.defer(function(){this._working=false;if(this.process){this.process.hide()}},300)},fitCanvas:function(){var w=this.canvas,B=w._data;var x,u,s,r;k.forEach(B,function(E){var D=E.points;k.forEach(D,function(G){var F=G.x;y=G.y;if(!x||!s){x=s=F}if(!u||!r){u=r=y}if(F<x){x=F}if(y<u){u=y}if(y>r){r=y}if(F>s){s=F}},this)},this);var v=this.canvasEdgeSet({minY:u,maxY:r});if(v){u=v.minY;r=v.maxY}var A=s-x,z=r-u;var t=document.createElement("canvas");var C=t.getContext("2d");t.width=A+20;t.height=z+20;C.drawImage(w.canvas,x,u,A,z,10,10,A,z);return t},canvasEdgeSet:function(r){if(!r){return}if(r.minY&&r.minY<0){r.minY=0}if(r.maxY&&r.maxY>this.canvas.canvas.height){r.maxY=this.canvas.canvas.height}return r},fitCanvasY:function(){var w=this.canvas,r=w._data;var z,v;k.forEach(r,function(B){var A=B.points;k.forEach(A,function(C){var D=C.y;if(!z||!v){z=v=D}if(D<z){z=D}if(D>v){v=D}},this)},this);var x=this.canvasEdgeSet({minY:z,maxY:v});if(x){z=x.minY;v=x.maxY}var t=v-z;var u=document.createElement("canvas");var s=u.getContext("2d");u.width=w.canvas.width;u.height=t+20;s.drawImage(w.canvas,0,z,w.canvas.width,t,10,10,w.canvas.width,t);return u},auditNoteViewSave:function(){if(f.byId("_flowNav")){i.set(f.byId("_flowNav"),{display:"block"})}if(this._working){return}if(this.canvas&&this.canvas._data&&this.canvas._data.length>0){this._working=true;this.process=q.processing().show();var r=this.canvas;if(this.isFitCanvas){r=this.fitCanvas()}o.uploadFile({options:this,evt:{dataURL:r.toDataURL("image/png")}})}else{q.tip({text:e["mui.hand.empty.tip"]}).show()}},AttUploadSuccessEreb:function(s,r){m("#imgUl li").remove();this.fileIds=[];if(r==null||r.file==null){this.workDone();return}var t=r.file;this.fileIds.push(t.filekey);this.UploadSuccessed(s,r);this.workDone()},AttUploadSuccess:function(s,r){if(r==null||r.file==null){this.workDone();return}var t=r.file;this.fileIds.push(t.filekey);this.UploadSuccessed(s,r);this.hideAuditNoteHandlerView();this.auditNoteViewClear();this.workDone()},UploadSuccessed:function(s,r){},AttUploadError:function(){this.workDone()}})})},"sys/lbpmservice/mobile/audit_note_ext/hand/AuditNoteHandlerView":function(){define(["dojo/_base/declare","dojo/query","dojo/touch","mui/util","dojo/_base/lang","dojo/_base/array","dojo/on","sys/lbpmservice/mobile/audit_note_ext/_CanvasView","mui/i18n/_i18n!sys/lbpmservice/mobile/sys-lbpm-note","mui/device/adapter","dojo/topic","mui/device/device","dojo/dom-class"],function(f,k,e,h,b,i,j,n,d,m,g,a,l){return f("sys.lbpmservice.mobile.audit_note_ext.hand.AuditNoteHandlerView",[n],{descriptionDiv:null,buttonDiv:null,startup:function(){this.inherited(arguments);this.createBtn();this.bindEvents();var o=this;window.addEventListener("resize",function(){o.resize()},false)},createBtn:function(){var p=k(this.buttonDiv);var o='<div class="handingWay" id="handwriting">';o+='<div class="iconArea"><i class="mui mui-handwrite"></i></div><span class="iconTitle">'+d["mui.lbpmNode.usage.handwrite"]+"</span></div>";p.append(o);k("#handwriting").on("click",b.hitch(this,this.showAuditNoteHandlerView))},showAuditNoteHandlerView:function(){this._canvasKey="auditNote";var p=a.getClientType();if(p==9||p==10){var o=m.getSignImage({options:this});if(o){return}}if(dojoConfig.dingXForm=="true"){$(this.fixedHeader).css("display","none")}g.publish("/lbpm/operation/hideDialog",this);this.inherited(arguments)},bindEvents:function(){lbpm.events.addListener(lbpm.constant.EVENT_validateMustSignYourSuggestion,function(){var o=k(".auditNoteHandlerImgUl");return(o.children().length>0)});j(k(this.descriptionDiv).parent()[0],j.selector("#imgUl li .btn_canncel_img",e.press),b.hitch(this,this.auditNoteViewDelete));this.inherited(arguments)},auditNoteViewDelete:function(o){if(o.target){var p=o.target.tagName=="SPAN"?o.target:k(o.target).parent("span")[0];if(p==null){return}this.fileIds=i.filter(this.fileIds,function(s){return s!=p.id});k("#li_"+p.id).remove();var r=k("#imgUl");var q=k("li","imgUl");if(q.length==1){k("li","imgUl").forEach(function(s){l.remove(s,"many")})}else{if(q.length==0){g.publish("/lbpm/ext/auditNoteHandler/change",this)}}g.publish("attachmentObject_delete_ereb",this,{})}},AttUploadSuccess:function(p,o){this.inherited(arguments);this._canvasKey=""},selectPenChange:function(o){if(o.name=="selectPenWidth"&&this._canvasKey=="auditNote"){this.dowidthchange()}if(o.name=="selectPenColor"&&this._canvasKey=="auditNote"){this.docolorchange()}},hideAuditNoteHandlerView:function(){if(dojoConfig.dingXForm=="true"){$(this.fixedHeader).css("display","")}if(this._canvasKey==="auditNote"){this.inherited(arguments);this._canvasKey=null}g.publish("/lbpm/operation/showDialog",this,{handwriting:true})},auditNoteViewClear:function(){if(this._canvasKey==="auditNote"){this.canvas.clear()}},UploadSuccessed:function(q,o){var s=o.file;if(a&&(a.getClientType()==7||a.getClientType()==8||a.getClientType()==9||a.getClientType()==10)){this.curDisplayHref=s.href}else{var u=this.fitCanvasY();if(u){this.curDisplayHref=u.toDataURL("image/png");var p=this.displayFiles||{};p[s.filekey]=this.curDisplayHref}}if(!this.curDisplayHref){this.curDisplayHref=s.href}var v=k("#imgUl");var r='<li class="imgLi" id="li_'+s.filekey+'"><div class="img_wrapper">';r+='<span class="btn_canncel_img fontmuis muis-epid-close" id="'+s.filekey+'"></span>';r+='<div class="img_content"><img width="100" height="auto" src="'+this.curDisplayHref+'"></div></div></li>';if(v.length>0){if(v.innerHTML()==""){v.innerHTML(r);k("li","imgUl").forEach(function(w){l.remove(w,"many")})}else{v.append(r);k("li","imgUl").forEach(function(w){l.add(w,"many")})}}else{var t='<div class="tab_img"><ul id="imgUl" class="auditNoteHandlerImgUl">'+r+"</tr></ul></div>";k(this.descriptionDiv).after(t)}g.publish("/lbpm/ext/auditNoteHandler/change",this)},onAfterTransitionOut:function(){this.inherited(arguments);if(this.showType!="dialog"){var o=this._getDomOffsetTop(k("#handwriting")[0]);var p=window;this._scrollTo(p,{y:0-o+110})}},_scrollTo:function(u,A){var x=0;if(A){x=A.y||0}var r=-x;var p=this.getPos(u).y;var z=r-p;var B=300;var w=30;var v=10;var q=z/v;var s=0;var o=window.setInterval(function(){if(s<=v-1){p+=q;s++;u.scrollTo(0,p)}else{window.clearInterval(o)}},w)},getPos:function(o){if(o==window){return{y:document.documentElement.scrollTop||document.body.scrollTop}}else{return{y:o.scrollTop}}},_getDomOffsetTop:function(q){var p=q;var o=0;while(p!=null&&p!=document.body){o+=p.offsetTop;p=p.offsetParent}return o}})})},"sys/lbpmservice/mobile/lbpm_audit_note/js/_LbpmserviceAuditLabelItemToggleMixin":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dijit/_WidgetBase","mui/util","dojo/query","dojo/_base/lang","dojo/topic","dojo/dom-class"],function(d,b,h,g,f,i,a,e,j){return d("sys.lbpmservice.audit.note._LbpmserviceAuditLabelItemToggleMixin",null,{toggle:false,_toggleClass:"hide",methodPrex:"show",startup:function(){this.inherited(arguments);if(this.toggle){b.create("i",null,this.titleNode);this.connect(this.domNode,"onclick","_onClick");this.subscribe("/mui/lbpmservice/label_toggle",a.hitch(this.label_toggle))}},_onClick:function(k){this._label_toggle()},_label_toggle:function(l){var k=l?l:this.getMehtodPrex();e.publish("/mui/lbpmservice/label_toggle",this,{fdExecutionId:this.fdExecutionId,methodPrex:k});this.set("methodPrex",k)},label_toggle:function(m,l){if(m!=this){return}var k=this.getMehtodPrex()=="hide"?true:false;j.toggle(this.titleNode,this._toggleClass,k)},getMehtodPrex:function(){return this.methodPrex=="show"?"hide":"show"}})})}}});require({cache:{"sys/lbpmservice/mobile/sys-lbpm-note_zh-cn._min_":function(){define("",{"mui.freeFlow.lbpm.node.processType_2.signNode":"会签","mui.signature.cancel":"取消","mui.freeFlow.lbpm.nodeType.signNode":"签字节点","mui.freeFlow.node.onAdjoinHandlerSame":"仅相邻处理人身份重复跳过","mui.freeFlow.tip.successChange":"修改成功","mui.lbpmservice.lbpmPostscript.load.failure":"新增流程附言加载失败","mui.hand.empty.tip":"请签批","mui.freeFlow.lbpm.oprItem.modifyProcessType":"修改流转方式","mui.extOperation.im.approver":"我是审批人","mui.extOperation.next":"下一步","mui.lbpmservice.lbpmAuditNote.fdCostTime":"耗时","mui.freeFlow.sendNode.nodeTitle":"多人抄送","mui.lbpmNode.usage.speech":"语音","mui.lbpmservice.node.hide":"隐藏","mui.extOperation.im.finishProcessor":"我是已处理人","mui.subform.transaction":"有待处理事务","mui.freeFlow.node.yes":"是","mui.errors.maxLength.simple":"{0} 超出 {1} 个英文字符限制","mui.commonUsage.tip.empty":"请输入数据","mui.lbpmservice.node.operation":"操作","mui.freeFlow.node.select":"请选择","mui.lbpmservice.flowchart.process.branch":"启动分支节点","mui.freeFlow.node.ignoreOnFutureHandlerSame":"后续处理人身份重复跳过当前","mui.freeFlow.node.flowPopedom_1":"增加节点","mui.freeFlow.node.flowPopedom_0":"无","mui.freeFlow.node.flowPopedom_2":"编辑流程","mui.freeFlow.reviewNode.processType_2.nodeTitle":"{0}人审批|会审","mui.commonUsage.manage":"管理","mui.commonUsage.del":"删除","mui.freeFlow.lbpm.node.processType_1":"并行","mui.freeFlow.lbpm.node.processType_0":"串行","mui.operation.commonUsage.none":"暂时没有数据","mui.freeFlow.node.close":"关闭","mui.extOperation.audit":"审批","mui.freeFlow.node.open":"开启","mui.freeFlow.node.set":"请设置","mui.freeFlow.lbpm.oprItem.viewHandler":"查看人员","mui.commonUsage.edit":"编辑","mui.freeFlow.node.deleteMsg":"确定删除该节点？","mui.operation.processed":"已处理","mui.signature.warn.msg":"密码错误，请重新输入","mui.lbpmservice.lbpmPostscript.ok":"确定","mui.lbpmNode.usage.handwrite.color.red":"红色","mui.subform.defaultForm":"默认表单","mui.lbpmNode.signature":"电子签章","mui.process.mobile.note":"流程记录","mui.freeFlow.lbpm.oprItem.insertNode":"添加节点","mui.operation.branchadmin":"分支特权人","mui.dialog.selectOrg":"选择","mui.freeFlow.draftorNode.default":"默认为本人","mui.freeFlow.lbpm.nodeType.sendNode":"抄送节点","mui.workitem.operation.transaction":"事务","mui.freeFlow.node.onSkipHandlerSame":"处理人身份重复跳过","mui.lbpmNode.usage.handwrite.color.blue":"蓝色","mui.lbpmNode.usage.handwrite.color.black":"黑色","mui.lbpmservice.node.operation.from":"来自","mui.freeFlow.node.canModifyMainDoc":"编辑主文档","mui.commonUsage.placeholder":"请输入审批语","mui.freeFlow.splitNode.deleteMsg":"您确定删除当前节点及后面所有节点吗?","mui.extOperation.operationselection":"操作选择","mui.freeFlow.tip.successInsert":"添加成功","mui.freeFlow.lbpm.oprItem.modifyHandler":"替换人员","mui.freeFlow.signNode.processType_2.nodeTitle":"{0}人签字|会签","mui.freeFlow.lbpm.nodeType.reviewNode":"审批节点","mui.freeFlow.node.more":"等","mui.lbpmNode.usage.handwrite.color":"颜色","mui.commonUsage.add":"添加审批语","mui.freeFlow.node.person":"人","mui.subform.defaultCurrForm":"默认表单(当前表单)","mui.lbpmNode.usage.handwrite":"手写","mui.lbpmNode.usage.handwrite.penWidth":"笔触","mui.freeFlow.node.attrSet":"节点设置","mui.freeFlow.node.canAddAuditNoteAtt":"审批意见中上传附件","mui.lbpmservice.lbpmPostscript":"回复","mui.freeFlow.lbpm.nodeType.robotNode":"机器人节点","mui.freeFlow.reviewNode.processType_0.nodeTitle":"{0}人审批|串行","mui.button.savedraft":"暂存","mui.lbpmservice.node.deleted":"此审批意见所属节点已删除","mui.freeFlow.draftorNode":"起草节点","mui.freeFlow.node.no":"否","mui.freeFlow.reviewNode.processType_1.nodeTitle":"{0}人审批|并行","mui.extOperation.finishProcessor":"已处理人","mui.lbpmNode.usage":"审批语","mui.freeFlow.lbpm.oprItem.modifyPopedom":"修改节点权限","mui.freeFlow.lbpm.node.processType_2.reviewNode":"会审","mui.extOperation.drafter":"起草人","mui.freeFlow.cancel":"取消","mui.freeFlow.node.ignoreOnHandlerSame":"处理人身份重复不跳过","mui.commonUsage.tip.same":"数据没有变更","mui.freeFlow.signNode.processType_0.nodeTitle":"{0}人签字|串行","mui.signature.input.password":"输入密码","mui.operation.drafter":"起草人","mui.subform.switchForm":"切换表单","mui.freeFlow.lbpm.node.flowPopedom_2":"编辑流程","mui.freeFlow.lbpm.node.flowPopedom_1":"增加节点","mui.freeFlow.lbpm.node.flowPopedom_0":"不可编辑","mui.lbpmservice.lbpmPostscript.cancel":"取消","mui.lbpmservice.flowchart.process.end":"结束","mui.freeFlow.signNode.processType_1.nodeTitle":"{0}人签字|并行","mui.extOperation.im.drafter":"我是起草人","mui.lbpmservice.flowchart.process.begin":"开始","mui.operation.commonUsage":"常用审批意见","mui.freeFlow.node.delete":"删除","mui.workitem.operation.other":"其他","mui.operation.process":"流程处理","mui.lbpmNode.usage.sign":"批注","mui.signature.ok":"确定","mui.subform.currForm":"当前表单","mui.lbpmAssign.operation.replyAssign":"回复分发","mui.lbpmAssign.operation.assign":"分发","mui.lbpm.process.status.fdStartDate":"接收时间","mui.lbpm.process.status.operationType":"操作状态","mui.lbpm.process.status.fdFinishDate":"操作时间","lbpm.tab.graphic":"流程图","lbpm.process.status.processStatus":"流程状态"})}}});